---
import Layout from "@/layouts/Layout.astro";
import Image from "astro/components/Image.astro";

import "@/styles/typography.css";

import { getCollection } from "astro:content";

export const prerender = true;

export async function getStaticPaths() {
  const noticias = await getCollection("noticias");

  return noticias.map((notice) => ({
    params: { slug: notice.slug },
    props: { notice },
  }));
}

const { notice } = Astro.props;
const { Content } = await notice.render();
---

<Layout canonical={`https://dandelion-rho.vercel.app/noticias/${notice.slug}`}>
  <section
    class="relative w-full min-h-[60svh] pt-20 bg-[#00353d] overflow-hidden"
  >
    <!-- Hero Background Image -->
    <div class="absolute inset-0">
      <Image
        src={notice.data.imagen}
        alt={notice.data.title}
        width={1600}
        height={900}
        sizes="100vw"
        format="webp"
        loading="eager"
        fetchpriority="high"
        class="w-full h-full object-cover"
      />
      <div
        class="absolute inset-0 bg-linear-to-b from-[#00353d]/40 via-[#00353d]/70 to-[#00353d]"
      >
      </div>
    </div>

    <!-- Hero Content -->
    <div class="relative z-10 max-w-5xl mx-auto px-6 pt-28 pb-20 text-center">
      <p class="text-sm uppercase tracking-widest text-white/70 mb-4">
        {
          new Date(notice.data.date).toLocaleDateString("es-AR", {
            day: "numeric",
            month: "long",
            year: "numeric",
          })
        }
      </p>

      <h1
        class="text-3xl md:text-5xl font-bold text-white leading-tight text-balance"
      >
        {notice.data.title}
      </h1>

      {
        notice.data.subtitulo && (
          <p class="mt-6 text-lg md:text-xl text-white/90 max-w-2xl mx-auto">
            {notice.data.subtitulo}
          </p>
        )
      }
    </div>
  </section>

  <!-- Article -->
  <section class="relative py-12 md:py-16">
    <article
      class="content-article overflow-hidden
    prose prose-lg md:prose-xl
    max-w-4xl mx-auto px-5
    prose-p:my-3
    prose-headings:mt-6 prose-headings:mb-3
    prose-img:my-6
    prose-blockquote:my-4
    prose-hr:my-6
    prose-blockquote:border-black/20
    prose-img:rounded-xl
    prose-img:max-w-full
    prose-img:w-full
    prose-img:h-auto
    prose-img:shadow-xl
    prose-img:shadow-white/30
    prose-video:rounded-xl
    prose-video:w-full"
    >
      <Content />
    </article>
  </section>
</Layout>
