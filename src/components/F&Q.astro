---
export const faqs = [
  {
    question: "¿Cómo puedo escuchar la radio en línea?",
    answer:
      "Puedes escucharnos desde nuestra web oficial o desde plataformas de streaming compatibles.",
    open: false,
  },
  {
    question: "¿Puedo solicitar una canción?",
    answer:
      "Sí, puedes solicitar canciones a través de nuestras redes sociales o durante los programas en vivo.",
    open: false,
  },
  {
    question: "¿Cómo puedo participar en los programas en vivo?",
    answer:
      "Puedes llamarnos en vivo, enviarnos mensajes por WhatsApp o interactuar en nuestras redes sociales. Nos encanta escuchar a nuestra audiencia.",
    open: false, // ← este estaba abierto en tu HTML
  },
  {
    question: "¿Tienen una programación fija?",
    answer:
      "Sí, contamos con una grilla de programación diaria que puedes consultar en nuestra web.",
    open: false,
  },
  {
    question: "¿Cómo puedo anunciarme en la radio?",
    answer:
      "Puedes contactarnos a través de nuestro formulario de contacto o enviarnos un mensaje directo para recibir asesoramiento comercial.",
    open: false,
  },
];
---

<section
  class="container mx-auto py-16 px-[2vh] md:px-5 lg:px-0 flex flex-col items-center justify-center bg-white"
>
  <h6
    class="text-[#00c195] mb-4 text-xl font-bold text-center uppercase undefined"
  >
    Preguntas frecuentes
  </h6><h3
    class="text-3xl md:text-5xl max-w-xl text-center font-semibold undefined"
  >
    ¿Preguntas? tenemos respuestas
  </h3>
  <div id="questions" class="mt-12 flex flex-col gap-6 max-w-2xl mx-auto">
    {
      faqs.map((faq, i) => (
        <div
          class="faq border border-black/50 bg-black/10 rounded-lg p-6 cursor-pointer"
          data-index={i}
        >
          <div class="flex justify-between items-center">
            <h3 class="font-medium">{faq.question}</h3>

            <svg
              class="faq-icon shrink-0"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <line x1="12" y1="5" x2="12" y2="19" />
              <line x1="5" y1="12" x2="19" y2="12" />
            </svg>
          </div>

          <div class="faq-content overflow-hidden">
            <div class="pt-6">
              <p>{faq.answer}</p>
            </div>
          </div>
        </div>
      ))
    }
  </div>
</section>

<script>
  import gsap from "gsap";

  const faqs = document.querySelectorAll<HTMLElement>(".faq");

  faqs.forEach((faq) => {
    const content = faq.querySelector<HTMLElement>(".faq-content");
    const icon = faq.querySelector<SVGElement>(".faq-icon");

    if (!content || !icon) return;

    const inner = content.firstElementChild as HTMLElement | null;
    if (!inner) return;

    let isOpen = false;

    // Estado inicial
    gsap.set(content, {
      height: isOpen ? "auto" : 0,
      opacity: isOpen ? 1 : 0,
    });

    gsap.set(icon, {
      rotate: isOpen ? 45 : 0,
    });

    // Timeline
    const tl = gsap.timeline({
      paused: true,
      defaults: { duration: 0.45, ease: "power3.inOut" },
    });

    tl.to(content, {
      height: () => inner.offsetHeight,
      opacity: 1,
    }).to(
      icon,
      {
        rotate: 45,
        duration: 0.35,
        ease: "power2.out",
      },
      0,
    );

    if (isOpen) tl.progress(1);

    faq.addEventListener("click", () => {
      isOpen = !isOpen;

      if (isOpen) {
        tl.play(0); // ← clave
      } else {
        tl.reverse(); // ← clave
      }
    });
  });
</script>
